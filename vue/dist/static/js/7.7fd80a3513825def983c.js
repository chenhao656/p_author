webpackJsonp([7],{rOEp:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("uXZL"),n=i.n(o),s={data:function(){return{totalCount:0,list:[],listLoading:!1,listQuery:{pageNum:1,pageRow:50,name:""},deletelist:[],dialogStatus:"create",dialogFormVisible:!1,textMap:{update:"编辑",create:"添加布控人员"},tempPersonmonitor:{id:"",id_no:"",name:"",sex:"男",id_card:"",birthplace:"",type:"",case_type:""},items:[{name:"男",id:"1"},{name:"女",id:"2"}],searchcondition:{param:""}}},created:function(){this.getList()},methods:{getList:function(){var t=this;this.hasPerm("personmonitor:list")&&(this.listLoading=!0,this.api({url:"/personmonitor/listPersonmonitor",method:"get",params:this.listQuery}).then(function(e){t.listLoading=!1,t.list=e.list,t.totalCount=e.totalCount}))},conditionChange:function(t){this.searchcondition.param=t},search:function(){var t=this;""!=this.searchcondition.param?this.api({url:"/personmonitor/queryPersonmonitor",method:"get",params:this.searchcondition}).then(function(e){t.listLoading=!1,t.list=e.list,t.totalCount=e.totalCount}):this.getList()},hideRow:function(t){this.show=!1},handleSizeChange:function(t){this.listQuery.pageRow=t,this.handleFilter()},handleCurrentChange:function(t){this.listQuery.pageNum=t,this.getList()},getIndex:function(t){return(this.listQuery.pageNum-1)*this.listQuery.pageRow+t+1},showCreate:function(){this.dialogStatus="create",this.dialogFormVisible=!0},showUpdate:function(t){this.tempPersonmonitor.id=this.list[t].id,this.tempPersonmonitor.id_no=this.list[t].id_no,this.tempPersonmonitor.id_card=this.list[t].id_card,this.tempPersonmonitor.sex=this.list[t].sex,this.tempPersonmonitor.birthplace=this.list[t].birthplace,this.tempPersonmonitor.type=this.list[t].type,this.tempPersonmonitor.case_type=this.list[t].case_type,this.tempPersonmonitor.name=this.list[t].name,this.dialogStatus="update",this.dialogFormVisible=!0},createpersonmonitor:function(){var t=this;this.api({url:"/personmonitor/addPersonmonitor",method:"post",data:this.tempPersonmonitor}).then(function(){t.getList(),t.dialogFormVisible=!1})},updatepersonmonitor:function(){var t=this;this.api({url:"/personmonitor/updatepersonmonitor",method:"post",data:this.tempPersonmonitor}).then(function(){t.getList(),t.dialogFormVisible=!1})},showDel:function(t){var e=this;0==this.deletelist.length?this.$message({type:"info",message:"请选中需要删除的人员!"}):this.$confirm("确定删除选中人员？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.api({url:"/personmonitor/deletePersonmonitor",method:"post",data:e.deletelist}).then(function(){e.getList()}),e.$message({type:"success",message:"删除成功!"})}).catch(function(){e.$message({type:"info",message:"已取消删除"})})},handleSelectionChange:function(t){console.log(t);for(var e=0;e<t.length;e++)this.deletelist=t},readExcel:function(t){var e=this,i=new FileReader;i.onload=function(t){try{var i=t.target.result,o=n.a.read(i,{type:"binary"});for(var s in o.Sheets){var a=n.a.utils.sheet_to_json(o.Sheets[s]);if(console.log(a),a.length>0){if(!a[0].hasOwnProperty("姓名"))return e.$message({type:"info",message:"表头格式有误，找不到姓名列!"}),!1;if(!a[0].hasOwnProperty("人员编号"))return e.$message({type:"info",message:"表头格式有误，找不到人员编号列!"}),!1;if(!a[0].hasOwnProperty("身份证号"))return e.$message({type:"info",message:"表头格式有误，找不到身份证号列!"}),!1;if(!a[0].hasOwnProperty("性别"))return e.$message({type:"info",message:"表头格式有误，找不到性别列!"}),!1;if(!a[0].hasOwnProperty("户籍地"))return e.$message({type:"info",message:"表头格式有误，找不到户籍地列!"}),!1;if(!a[0].hasOwnProperty("人员类别"))return e.$message({type:"info",message:"表头格式有误，找不到人员类别列!"}),!1;if(!a[0].hasOwnProperty("案件类别"))return e.$message({type:"info",message:"表头格式有误，找不到案件类别列!"}),!1;var r=[],l={};for(var p in a)(l={}).name=a[p].姓名,l.id_no=a[p].人员编号,l.sex=a[p].性别,l.id_card=a[p].身份证号,l.type=a[p].人员类别,l.case_type=a[p].案件类别,l.birthplace=a[p].户籍地,r[p]=l;e.api({url:"/personmonitor/bulkaddPersonmonitor",method:"post",data:r}).then(function(){e.getList()})}}}catch(t){return e.$message.warning("文件类型不正确！"),!1}},i.readAsBinaryString(t.raw)}}},a={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-form",[i("el-form-item",[i("el-input",{staticStyle:{width:"200px"},attrs:{v_model:"this.searchcondition.param",placeholder:"身份证号或姓名",size:"small"},on:{change:t.conditionChange}}),i("el-button",{attrs:{type:"primary",icon:"el-icon-search",size:"small"},on:{click:t.search}},[t._v("搜索")]),t._v(" "),t.hasPerm("personmonitor:add")?i("el-button",{attrs:{type:"primary",icon:"plus",size:"small"},on:{click:t.showCreate}},[t._v("添加布控人员\n        ")]):t._e(),t._v(" "),i("el-button",{attrs:{type:"danger",icon:"edit",size:"small"},on:{click:function(e){t.showDel(t.deletelist)}}},[t._v("删除")]),t._v(" "),i("el-upload",{ref:"upload",attrs:{action:"/wm/upload/","show-file-list":!1,"on-change":t.readExcel,"auto-upload":!1}},[i("el-button",{attrs:{slot:"trigger",icon:"el-icon-upload",size:"small",type:"primary"},slot:"trigger"},[t._v("\n            批量上传\n          ")])],1)],1)],1)],1),t._v(" "),i("el-table",{directives:[{name:"loading",rawName:"v-loading.body",value:t.listLoading,expression:"listLoading",modifiers:{body:!0}}],attrs:{data:t.list,"element-loading-text":"拼命加载中",border:"",fit:"","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[i("el-table-column",{attrs:{type:"selection",width:"55",s:""}}),t._v(" "),i("el-table-column",{attrs:{align:"center",label:"序号",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("span",{domProps:{textContent:t._s(t.getIndex(e.$index))}})]}}])}),t._v(" "),t._e(),t._v(" "),i("el-table-column",{staticStyle:{width:"160px"},attrs:{align:"center",prop:"id_no",label:"人员编号"}}),t._v(" "),i("el-table-column",{staticStyle:{width:"60px"},attrs:{align:"center",prop:"name",label:"姓名"}}),t._v(" "),i("el-table-column",{staticStyle:{width:"30px"},attrs:{align:"center",prop:"sex",label:"性别"}}),t._v(" "),i("el-table-column",{attrs:{align:"center",prop:"id_card",label:"身份证号",width:"200"}}),t._v(" "),i("el-table-column",{staticStyle:{width:"60px"},attrs:{align:"center",prop:"birthplace",label:"户籍地"}}),t._v(" "),i("el-table-column",{staticStyle:{width:"60px"},attrs:{align:"center",prop:"type",label:"人员类别"}}),t._v(" "),i("el-table-column",{staticStyle:{width:"60px"},attrs:{align:"center",prop:"case_type",label:"案件类别"}}),t._v(" "),t.hasPerm("personmonitor:update")?i("el-table-column",{attrs:{align:"center",label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{type:"primary",icon:"edit"},on:{click:function(i){t.showUpdate(e.$index)}}},[t._v("修改")])]}}])}):t._e()],1),t._v(" "),i("el-pagination",{attrs:{"current-page":t.listQuery.pageNum,"page-size":t.listQuery.pageRow,total:t.totalCount,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}}),t._v(" "),i("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{staticClass:"small-space",staticStyle:{width:"300px","margin-left":"50px"},attrs:{model:t.tempPersonmonitor,"label-position":"left","label-width":"100px"}},[i("el-form-item",{attrs:{label:"人员编号"}},[i("el-input",{attrs:{type:"text"},model:{value:t.tempPersonmonitor.id_no,callback:function(e){t.$set(t.tempPersonmonitor,"id_no",e)},expression:"tempPersonmonitor.id_no"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"姓名"}},[i("el-input",{attrs:{type:"text"},model:{value:t.tempPersonmonitor.name,callback:function(e){t.$set(t.tempPersonmonitor,"name",e)},expression:"tempPersonmonitor.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"性别"}},[i("el-select",{attrs:{placeholder:"请选择"},model:{value:t.tempPersonmonitor.sex,callback:function(e){t.$set(t.tempPersonmonitor,"sex",e)},expression:"tempPersonmonitor.sex"}},t._l(t.items,function(t){return i("el-option",{key:"item.id",attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),i("el-form-item",{attrs:{label:"身份证号"}},[i("el-input",{attrs:{type:"text"},model:{value:t.tempPersonmonitor.id_card,callback:function(e){t.$set(t.tempPersonmonitor,"id_card",e)},expression:"tempPersonmonitor.id_card"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"户籍地"}},[i("el-input",{attrs:{type:"text"},model:{value:t.tempPersonmonitor.birthplace,callback:function(e){t.$set(t.tempPersonmonitor,"birthplace",e)},expression:"tempPersonmonitor.birthplace"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"人员类别"}},[i("el-input",{attrs:{type:"text"},model:{value:t.tempPersonmonitor.type,callback:function(e){t.$set(t.tempPersonmonitor,"type",e)},expression:"tempPersonmonitor.type"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"案件类别"}},[i("el-input",{attrs:{type:"text"},model:{value:t.tempPersonmonitor.case_type,callback:function(e){t.$set(t.tempPersonmonitor,"case_type",e)},expression:"tempPersonmonitor.case_type"}})],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),"create"==t.dialogStatus?i("el-button",{attrs:{type:"success"},on:{click:t.createpersonmonitor}},[t._v("创 建")]):i("el-button",{attrs:{type:"primary"},on:{click:t.updatepersonmonitor}},[t._v("保 存")])],1)],1)],1)},staticRenderFns:[]},r=i("VU/8")(s,a,!1,null,null,null);e.default=r.exports}});