webpackJsonp([1],{"Tr/r":function(e,t,r){var n=r("p38T");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);r("rjj0")("3be0b927",n,!0)},k3tE:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r("//Fk"),a=r.n(n),i=r("uXZL"),o=r.n(i),s={props:{beforeUpload:Function,onSuccess:Function},data:function(){return{loading:!1,excelData:{header:null,results:null}}},methods:{generateData:function(e){var t=e.header,r=e.results;this.excelData.header=t,this.excelData.results=r,this.onSuccess&&this.onSuccess(this.excelData)},handleDrop:function(e){if(e.stopPropagation(),e.preventDefault(),!this.loading){var t=e.dataTransfer.files;if(1===t.length){var r=t[0];if(!this.isExcel(r))return this.$message.error("Only supports upload .xlsx, .xls, .csv suffix files"),!1;this.upload(r),e.stopPropagation(),e.preventDefault()}else this.$message.error("Only support uploading one file!")}},handleDragover:function(e){e.stopPropagation(),e.preventDefault(),e.dataTransfer.dropEffect="copy"},handleUpload:function(){this.$refs["excel-upload-input"].click()},handleClick:function(e){var t=e.target.files[0];t&&this.upload(t)},upload:function(e){(this.$refs["excel-upload-input"].value=null,this.beforeUpload)?this.beforeUpload(e)&&this.readerData(e):this.readerData(e)},readerData:function(e){var t=this;return this.loading=!0,new a.a(function(r,n){var a=new FileReader;a.onload=function(e){var n=e.target.result,a=t.fixData(n),i=o.a.read(btoa(a),{type:"base64"}),s=i.SheetNames[0],l=i.Sheets[s],c=t.getHeaderRow(l),d=o.a.utils.sheet_to_json(l);t.generateData({header:c,results:d}),t.loading=!1,r()},a.readAsArrayBuffer(e)})},fixData:function(e){for(var t="",r=0,n=10240;r<e.byteLength/n;++r)t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(r*n,r*n+n)));return t+=String.fromCharCode.apply(null,new Uint8Array(e.slice(r*n)))},getHeaderRow:function(e){var t=[],r=o.a.utils.decode_range(e["!ref"]),n=void 0,a=r.s.r;for(n=r.s.c;n<=r.e.c;++n){var i=e[o.a.utils.encode_cell({c:n,r:a})],s="UNKNOWN "+n;i&&i.t&&(s=o.a.utils.format_cell(i)),t.push(s)}return t},isExcel:function(e){return/\.(xlsx|xls|csv)$/.test(e.name)}}},l={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("input",{ref:"excel-upload-input",staticClass:"excel-upload-input",attrs:{type:"file",accept:".xlsx, .xls"},on:{change:e.handleClick}}),e._v(" "),r("div",{staticClass:"drop",on:{drop:e.handleDrop,dragover:e.handleDragover,dragenter:e.handleDragover}},[e._v("\n    批量添加\n    "),r("el-button",{staticStyle:{"margin-left":"16px"},attrs:{loading:e.loading,size:"mini",type:"primary"},on:{click:e.handleUpload}},[e._v("选择文件")])],1)])},staticRenderFns:[]};var c={name:"UploadExcel",components:{UploadExcelComponent:r("VU/8")(s,l,!1,function(e){r("Tr/r")},"data-v-cc5426fc",null).exports},data:function(){return{tableData:[],tableHeader:[]}},methods:{mounted:function(){},readExcel:function(e){var t=this,r=e.target.files,n=new FileReader;n.onload=function(e){try{var r=e.target.result,n=XLSX.read(r,{type:"binary"});for(var a in n.Sheets)XLSX.utils.sheet_to_json(n.Sheets[a])}catch(e){return t.$message.warning("文件类型不正确！"),!1}},n.readAsBinaryString(r[0])},beforeUpload:function(e){return e.size/1024/1024<1||(this.$message({message:"上传的Excel文件不能大于1mb.",type:"warning"}),!1)},handleSuccess:function(e){var t=e.results,r=e.header;this.tableData=t,this.tableHeader=r},importfxx:function(e){this.$refs.inputer;this.file=event.currentTarget.files[0];var t=this.file,n=new FileReader;FileReader.prototype.readAsBinaryString=function(e){var t,n,a="",i=new FileReader;i.onload=function(e){for(var o=new Uint8Array(i.result),s=o.byteLength,l=0;l<s;l++)a+=String.fromCharCode(o[l]);var c=r("uXZL");t=c.read(a,{type:"binary"}),n=c.utils.sheet_to_json(t.Sheets[t.SheetNames[0]]),console.log(n),console.log(n[0]),console.log(n[0].姓名)},i.readAsArrayBuffer(e)},n.readAsBinaryString(t)}}},d={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container"},[r("h1",[e._v("测试页面")]),e._v(" "),r("el-alert",{attrs:{title:"警告提示的文案",type:"warning"}}),e._v(" "),r("el-alert",{attrs:{title:"成功提示的文案",type:"success"}}),e._v(" "),r("el-alert",{attrs:{title:"消息提示的文案",type:"info"}}),e._v(" "),r("el-alert",{attrs:{title:"警告提示的文案",type:"warning"}}),e._v(" "),r("el-alert",{attrs:{title:"错误提示的文案",type:"error"}}),e._v(" "),r("el-alert",{attrs:{title:"成功提示的文案",type:"warning",description:"文字说明文字说明文字说明文字说明文字说明文字说明","show-icon":""}}),e._v(" "),r("el-button",{attrs:{type:"text"},on:{click:e.open2}},[e._v("点击打开 Message Box")])],1)},staticRenderFns:[]},u=r("VU/8")(c,d,!1,null,null,null);t.default=u.exports},p38T:function(e,t,r){(e.exports=r("FZ+f")(!0)).push([e.i,"\n.excel-upload-input[data-v-cc5426fc]{\r\n  display: none;\r\n  z-index: -9999;\n}\n.drop[data-v-cc5426fc]{\r\n  border: 2px dashed #bbb;\r\n  width: 600px;\r\n  height: 160px;\r\n  line-height: 160px;\r\n  margin: 0 auto;\r\n  font-size: 24px;\r\n  border-radius: 5px;\r\n  text-align: center;\r\n  color: #bbb;\r\n  position: relative;\n}\r\n","",{version:3,sources:["D:/vue_demo/p_author/vue/src/components/UploadExcel/index.vue"],names:[],mappings:";AACA;EACE,cAAc;EACd,eAAe;CAChB;AACD;EACE,wBAAwB;EACxB,aAAa;EACb,cAAc;EACd,mBAAmB;EACnB,eAAe;EACf,gBAAgB;EAChB,mBAAmB;EACnB,mBAAmB;EACnB,YAAY;EACZ,mBAAmB;CACpB",file:"index.vue",sourcesContent:["\n.excel-upload-input[data-v-cc5426fc]{\r\n  display: none;\r\n  z-index: -9999;\n}\n.drop[data-v-cc5426fc]{\r\n  border: 2px dashed #bbb;\r\n  width: 600px;\r\n  height: 160px;\r\n  line-height: 160px;\r\n  margin: 0 auto;\r\n  font-size: 24px;\r\n  border-radius: 5px;\r\n  text-align: center;\r\n  color: #bbb;\r\n  position: relative;\n}\r\n"],sourceRoot:""}])}});